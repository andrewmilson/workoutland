<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,minimum-scale=1.0,user-scalable=no">
    <title>Workout Land</title>

    <script>
      window.isApp = /^file/.test(location.protocol);
      window.isLocalhost = 'localhost' == location.hostname;
      window.website = 'workout.land';

      document.write(isApp ? '' : '\<base href=\"/\"\>')
      document.write((isApp ? [
        'bower_components/angular/angular.min.js',
        'bower_components/jquery/dist/jquery.min.js',
        'bower_components/angular-ui-router/release/angular-ui-router.min.js',
        'bower_components/angular-sanitize/sanitize.min.js',
        'js/create.js',
        'js/workout.js',
        'js/workouts.js',
        'js/app.js',
        'cordova.js'
      ] : [
        'js/mespeak.js',
        'https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js',
        'https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.14/angular-ui-router.min.js',
        'http://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular-sanitize.js',
        'js/create.js',
        'js/workout.js',
        'js/workouts.js',
        'js/app.js'
      ]).map(function(s) {
        return '\<script src=\"' + s + '\"\>\<\/script\>';
      }).join(''))
    </script>

    <script>
      if (!isApp) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-51793300-5', 'auto');
        ga('send', 'pageview');
      }
    </script>

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/open-sans.css">
    <link rel="stylesheet" href="fonts/icomoon/style.css">
  </head>
  <body>
    <div class="nav nav-top">
      <div class="nav-inner">
        <div id="container">
          <a wl-href="/c">CREATE</a>
          <a wl-href="/">WORKOUTS</a>
        </div>
      </div>
    </div>
    <div id="view">
      <script>
        if (!isApp) {
          document.write([
          '\<div class=\"grid\" style=\"padding-top: 15px;\"\>',
            '\<div class=\"col-6 text-right\"\>',
              '\<a href=\"https://play.google.com/store/apps/details?id=com.andrewmilson.workoutland\"\>',
                '\<img src=\"img/play-store.png\" style=\"margin-right: 10px;\" height=\"45px\" alt=\"\"\>',
              '\</a\>',
            '\</div\>',
            '\<div class=\"col-6\"\>Download to play \<br\>workouts offline!\</div\>',
          '\</div\>',
          '\<hr\>'].join(''));
        }
      </script>
      <div ui-view></div>
    </div>
    <script>
      if (!isApp) document.write('\<script src=\"js/mespeak.js\"\>\<\/script\>')
    </script>
    <script>
      function loadJS(fimeName){
        var script = document.createElement('script')
        script.setAttribute("src", fimeName)
        document.getElementsByTagName("head")[0].appendChild(script)
      }

      function bootstrapAngular() {
        angular.bootstrap(document.body, ['workoutland']);
      }

      if (isApp) {
        document.addEventListener('deviceready', function() {
          bootstrapAngular()
          navigator.tts.startup()
          window.webintent.getUri(function(uri) {
            if (!/^http/.test(uri)) return;
            var workoutId = /^(?:[^\/]*(?:\/(?:\/[^\/]*\/?)?)?([^?]+)(?:\??.+)?)$/.exec(uri)[1];
            window.location.replace('#/' + workoutId);
          }, false);
        });
      } else {
        bootstrapAngular();
        meSpeak.loadConfig("js/mespeak_config.json");
        meSpeak.loadVoice('js/en-us.json');
      }
    </script>
  </body>
</html>
